<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <script>
        var emails = {{ emails|tojson|safe }};
        console.log(emails); // Debugging line to check the value of emails
    </script>
    <script src="{{ url_for('static', filename='js/script.js') }}" defer></script>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="header-container">
            <div class="logo-container">
                <h1>Email Detailed View</h1>
                <p class="subtitle">Your email assistant, organized.</p>
            </div>
            <nav class="header-nav">
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/emails">Email Overview</a></li>
                    <li><a href="#">Settings</a></li>
                    <li><a href="/logout">Log Out</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Filters Row -->
    <div class="filters-row">
        <label for="priority-filter">Filter by Priority:</label>
        <select id="priority-filter" onchange="filterEmails()">
            <option value="all">All</option>
            <option value="high">High</option>
            <option value="medium">Medium</option>
            <option value="low">Low</option>
        </select>

        <label for="category-filter">Filter by Category:</label>
        <select id="category-filter" onchange="filterEmails()">
            <option value="all">All</option>
            <option value="work">High Priority</option>
            <option value="work">Work</option>
            <option value="personal">Personal</option>
            <option value="promotions">Promotions</option>
        </select>
    </div>

    <!-- Updated Content Section -->
    <div class="container">
        <!-- Left Column: Email List -->
        <div class="email-list-column">
            <ul class="email-list">
                {% for email in emails %}
                <li class="email-item" data-priority='{{ email.priority_level }}' data-email='{{ email|tojson|safe|e }}' onclick='loadEmailDetails({{ email|tojson|safe|e }})'>
                    <div class="email-header">
                        <strong>{{ email.sender }}</strong>
                        <span class="email-priority_level {{ email.priority_level }}">{{ email.priority_level }}</span>
                    </div>
                    <p class="email-subject">{{ email.subject }}</p>
                    <p class="email-summary-preview">{{ email.summary }}</p>
                </li>
                {% endfor %}
            </ul>
        </div>

        <!-- Right Column: Email Details -->
        <div class="email-details-column">
            <div id="email-details">
                <h2 id="details-subject"></h2>
                
                <div class="email-meta">
                    <div class="summary-actions-box">
                        <div class="sender-date">
                            <div class="sender" id="details-sender"></div>
                            <div class="date" id="details-date"></div>
                        </div>
                        
                        <div class="tags-container">
                            <div class="tag" id="details-priority"></div>
                            <div class="tag category" id="details-category"></div>
                        </div>
                        <div class="summary-section">
                            <h3>Summary</h3>
                            <p id="details-summary"></p>
                            <ul id="key-dates-list"></ul>
                        </div>
                        
                        <!-- <div class="action-items">
                            <h3>Action Items</h3>
                            <ul id="key-dates-list"></ul>
                        </div> -->
                    </div>
                </div>

                <div id="details-body">
                    <div id="email-body" class="email-body-container">
                        <!-- iframe will be inserted here by JavaScript -->
                    </div>
                </div>

                <!-- Response Section -->
                <div id="email-response">
                    <h3>Draft a Response:</h3>
                    <textarea id="response-draft" rows="6" placeholder="Write your response here..."></textarea>
                    <button id="send-button" onclick="sendEmailResponse()">Send</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Section -->
    <footer>
        <div class="footer-container">
            <div class="footer-left">
                <p>&copy; 2025 Beacon by Shronas. All rights reserved.</p>
            </div>
            <div class="footer-right">
                <ul>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Terms of Service</a></li>
                    <li><a href="#">Support</a></li>
                </ul>
            </div>
        </div>
    </footer>
</body>
</html>
